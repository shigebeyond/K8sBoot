- set_vars:
    zk_host: 172.16.1.94:2181 # zk service vip + 容器端口
- app(kafka):
    - containers:
        kafka:
          image: wurstmeister/kafka
          ports:
            - "9092:9092:9092"
          env:
            KAFKA_BROKER_ID: "1"
            KAFKA_ZOOKEEPER_CONNECT: $zk_host # zk service vip + 容器端口
            KAFKA_LISTENERS: PLAINTEXT://:9092
            KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka-broker:9092
          volumes:
#            - /data/kafka/:/kafka:rw
#        kafka-manager:
#          image: sheepkiller/kafka-manager # web管理界面
#          env:
#              ZK_HOSTS: $zk_host
#          ports:
#            - "9100:9000"
    # 部署
    - deploy:
        hostname: kafka-broker
        replicas: 1 # 副本数
        nodeSelector: # 节点选择: dict形式
          kubernetes.io/hostname: mac
