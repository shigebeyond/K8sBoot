- app(kafka):
    - containers:
        zookeeper:
          image: wurstmeister/zookeeper
          env:
            TZ: Asia/Shanghai
          ports:
            - "2181:2181"
          volumes:
            - /data/zookeeper/:/opt/zookeeper-3.4.13/data:rw
        kafka:
          image: wurstmeister/kafka:2.13-2.7.0
          ports:
            - "9092:9092"
          env:
            TZ: Asia/Shanghai
            HOSTNAME: kfk
            KAFKA_ADVERTISED_HOST_NAME: ${ref_pod_field(metadata.name)} # pod name
            #KAFKA_ADVERTISED_HOST_NAME: 127.0.0.1
            KAFKA_ADVERTISED_PORT: 9092
            KAFKA_PORT: 9092
            #KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://127.0.0.1:9092
            KAFKA_LISTENERS: PLAINTEXT://:9092
            KAFKA_CREATE_TOPICS: "K8sServiceReplicas:1:1,topicDemo:1:1"
            KAFKA_ZOOKEEPER_CONNECT: localhost:2181
          volumes:
            - /data/kafka/:/kafka:rw
        kafka-manager:
          image: sheepkiller/kafka-manager # web管理界面
          env:
              ZK_HOSTS: localhost
          ports:
            - "9100:9000"
    # 部署
    - deploy:
        replicas: 1 # 副本数
        nodeSelector: # 节点选择: dict形式
          kubernetes.io/hostname: hww-pc
